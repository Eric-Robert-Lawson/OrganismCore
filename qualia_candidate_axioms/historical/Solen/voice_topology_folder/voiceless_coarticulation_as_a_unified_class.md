# RARFL: Voiceless Coarticulation as a Unified Class
## Reasoning Artifact — voice_physics v12
## February 2026

---

## OBSERVATION (what was noticed)

Eric said: "T and H are related. 'To' and 'Who'.
'Tate' and 'Hate'. rear, hear, near. (nh)ear?"

This was not a feature request.
It was a perceptual observation about the engine output —
that certain onset sounds were more similar across
phoneme classes than the engine was modeling them to be.

---

## QUESTION (what needed answering)

Is the similarity between H and stop aspiration (VOT)
and nasal release a hallucination — a surface pattern
in English orthography — or does it point to something
real in the acoustic physics?

---

## REASONING (the actual work)

### Step 1: What is H physically?

H = voiceless turbulent airflow through the vocal tract.
The tract is already configured for the following phoneme
before H begins. This is why H sounds different before
different vowels. "Hear" has a different H than "have."
The v11 fix instantiated this: H now filters noise through
the following phoneme's formant cascade.

### Step 2: What is VOT physically?

VOT (voice onset time) = the interval between a stop
burst and the onset of voicing. During VOT, the glottis
is open, the stop closure has released, and air flows
through the vocal tract before the vocal folds begin
vibrating. The tract is already configured for the
following vowel because coarticulation has begun.

VOT = voiceless turbulent airflow through a tract
already configured for the following phoneme.

This is the same physical description as H.

### Step 3: What was the engine doing wrong?

In v11, the VOT zone used `noise_full` — flat broadband
noise, uncalibrated, no spectral shaping. The same noise
that was used everywhere before the H fix. The engine
modeled H and VOT as different physical events when they
are the same event at different time scales and in
different phonological contexts.

"To" (T→UW): VOT was flat noise.
"Who" (H→UW): bypass was UW-colored noise (v11).
The engine was making them less similar than they are.

### Step 4: What is nasal release physically?

When a nasal consonant (N, M, NG) releases into a vowel:
- The tongue tip (N) or lips (M) or velum (NG) open
- A brief constriction exists as the articulator moves
- Air pushes through the opening constriction
- Turbulent noise is produced, ~10-20ms
- The tract is already moving toward the vowel configuration

The key phrase: the tract is already moving toward the
vowel configuration. The noise is filtered by a tract
that is partially in the vowel shape.

This is the same physical description as H and VOT,
but at a much shorter time scale (~15ms vs ~80ms for H)
and with wider effective bandwidth because the
constriction is opening rather than stable.

### Step 5: Why do "near" and "hear" sound related?

Both begin with IH-colored onset noise.
"Hear": H produces ~80ms of IH-colored voiceless airflow.
"Near": N releases producing ~15ms of IH-colored
turbulent noise before the vowel body begins.

The engine was modeling the "hear" case (after v11)
but not the "near" case. The N→vowel transition was
handled only through formant trajectory interpolation —
smooth frequency movement — with no acoustic release
event. The release noise was absent.

"Rear" has neither: R→IH is a sonorant-to-vowel
transition with no turbulent release. It should sound
different from both "near" and "hear" at the onset.
This is the negative control.

### Step 6: The unified principle

All three events belong to the same physical class:

> Voiceless or near-voiceless turbulent airflow
> through a vocal tract already configured for,
> or moving toward, the following phoneme.

Members:
- H: long duration, full vowel configuration, stable
- VOT (T/K/P/CH): medium duration (~20-80ms),
  full vowel configuration, crossfade to voicing
- Nasal release (N/M/NG → vowel): short duration
  (~15ms), configuration partially open, wider BW

The fix is the same for all three:
_h_formant_filter() with the following phoneme's
formant values. The function already existed.
It just needed to be called in more places.

---

## RESOLUTION (what v12 implements)

### FIX 7: VOT coarticulation

For aspirated stops (P, T, K, CH) before any phoneme
with a stable tract configuration (vowels, sonorants,
nasals), the VOT noise is now generated by
_make_vot_noise(), which calls _h_formant_filter()
with the following phoneme's formants.

B/D/G excluded: pre-voiced or near-zero VOT.
The coarticulation effect is less audible for voiced
stops. Deferred to v13.

Boundary condition: if next_ph has no stable tract
configuration (stop following a stop, unknown), falls
back to HP-filtered broadband. Correct behavior:
there is no vowel configuration to preview.

### FIX 8: Nasal release noise

For vowels and sonorants that immediately follow a
nasal consonant, a brief (~15ms) turbulent onset burst
is added as a bypass_seg at the vowel's start position.

Generated by _make_nasal_release(), which calls
_h_formant_filter() with the following phoneme's
formants and BW widened by 2.5×.

BW widening rationale: the constriction is opening,
not at the stable vowel configuration. A wider bandwidth
resonator produces more turbulent, less pitched noise —
physically correct for a tract in transition rather
than at a target.

Gain is low (0.10): this is a brief onset event, not
a sustained sound. It should be heard as texture at
the vowel onset, not as a separate phoneme.

### Shared infrastructure

_get_coart_formants(next_ph): new shared lookup.
Returns (freqs, bws) for any phoneme. Used by H bypass,
VOT coloring, and nasal release. This is the single
point where the coarticulation principle is encoded.
H bypass now routes through this function rather than
doing its own inline lookup.

---

## WHAT THIS MEANS FOR FUTURE VERSIONS

The principle is now stated and instantiated:

> Any voiceless noise segment whose source is airflow
> through the vocal tract should be spectrally colored
> by the following phoneme's formant configuration,
> scaled by duration and constriction degree.

Remaining members of this class not yet addressed:

1. B/D/G VOT (near-zero, pre-voiced) — v13
2. Lateral release (L → vowel): tongue lateral edges
   releasing. Brief onset, different spectral character
   from nasals. v13 or v14.
3. Rhotic onset (R → vowel): retroflex constriction
   releasing. Very soft, highly vowel-colored. v13/v14.
4. /hw/ cluster (WH): H through a rounded tract
   moving toward W. Rare in modern English but present
   in WORD_SYLLABLES entries.
5. Affricate release (CH, JH): the frication portion
   of affricates is already handled as a fricative
   bypass. The transition from stop closure to frication
   has a brief VOT-like onset. May already be captured
   by FIX 7 if CH is in VOT_COLOR_PHS.

---

## META-COGNITIVE NOTE

This fix was found by listening, not by reading
phonetics literature. The observation "T and H are
related" came from hearing the engine output and
noticing that phonemes which should sound similar
at their onsets did not.

The correct direction of this work is:
  perception → principle → implementation
not:
  implementation → testing → perception.

The engine is being built from the outside in —
from what the ear hears toward what the physics
produces — rather than from the inside out.

This is the correct approach for a system whose
target is perceptual realism rather than
acoustic accuracy as measured by spectrogram.
Spectrograms and ears weight different features.
The ear is the ground truth.

---

## DIAGNOSTIC

Render pairs from v12 main block:
  slow_to.wav / slow_who.wav
  slow_tate.wav / slow_hate.wav
  slow_near.wav / slow_hear.wav / slow_rear.wav

Listen for:
- "to" and "who": same dark UW-colored onset noise.
  If FIX 7 is working, they should be indistinguishable
  at the onset and diverge only at the voicing onset.
- "near" and "hear": same IH-colored onset character.
  "near" onset should be shorter and slightly rougher
  (wider BW). "hear" onset should be longer and more
  resonant.
- "rear" should have no turbulent onset noise.
  The R→IH transition is smooth. If "rear" sounds
  like "hear" or "near" at the onset, the nasal
  release detection has a false positive.

The negative control ("rear") is as important as the
positive cases. If "rear" sounds like "near", the
fix is triggering incorrectly and the prev_ph check
needs tightening.
