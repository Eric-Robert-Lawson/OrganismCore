======================================================================
MYELODYSPLASTIC SYNDROME — FALSE ATTRACTOR ANALYSIS
Self-contained reproducible script
Dataset: GSE114922
Framework: OrganismCore Principles-First
Date: 2026-03-01
======================================================================

  GEO accession : GSE114922
  Samples       : 109 MDS | 22 healthy controls
  Cell type     : CD34+ HSPCs | bone marrow
  Data type     : Bulk RNA-seq (CPM)
  Subtypes      : SF3B1 | SRSF2 | U2AF1 | ZRSR2


=== STEP 0: DATA ACQUISITION ===
=================================================================
STEP 0: DATA ACQUISITION
Dataset: GSE114922
  109 MDS patients | 22 healthy controls
  CD34+ HSPCs | bone marrow bulk RNA-seq
=================================================================

  Checking for existing downloads...
  Already downloaded: GSE114922_CPM_table.txt.gz (18.4 MB) — skipping
  Already downloaded: GSE114922_CPM_table_fractions.txt.gz (6.2 MB) — skipping

  File status:
    cpm         : GSE114922_CPM_table.txt.gz (18.4 MB)
    cpm_frac    : GSE114922_CPM_table_fractions.txt.gz (6.2 MB)

=== STEP 1: METADATA ===

--- Fetching sample metadata from GEO ---
  Loaded from cache: 131 samples

=== STEP 2: LOAD EXPRESSION MATRIX ===

  Loading CPM matrix: GSE114922_CPM_table.txt.gz
  Raw shape: 63769 genes x 90 samples
  Target genes found  : 21/21
  Final shape : (90, 21)
  Index sample: ['A112', 'A114', 'A115', 'A116', 'A117']

=== STEP 3: MERGE AND CLASSIFY ===

  Merging expression with metadata...
  Merged shape: (90, 26)

  Group counts:
    NORMAL  : 8
    MDS     : 82
    UNKNOWN : 0

  Mutation status (MDS samples only):
    sf3b1_mutational_status: {'WT': np.int64(54), 'MUT': np.int64(28)}
    srsf2_mutational_status: {'WT': np.int64(74), 'MUT': np.int64(8)}
    u2af1_mutational_status: {'WT': np.int64(76), 'MUT': np.int64(6)}
    zrsr2_mutational_status: {'WT': np.int64(82)}

=== STEP 4: SADDLE POINT ANALYSIS ===

======================================================================
SADDLE POINT ANALYSIS — MDS HSPC vs NORMAL HSPC
======================================================================
  Normal HSPCs : 8
  MDS HSPCs    : 82

  FRAMEWORK PREDICTION (stated before data):
  Switch genes (SWITCH): suppressed in MDS
  False attractor (FA) : elevated in MDS

  Gene       Role           Normal      MDS    Change          p-value  Result
  ----------------------------------------------------------------------------------
  SPI1       SWITCH         7.4612   6.2858    -15.8%      p=0.1096  ns  NOT SUPPRESSED
  KLF4       SWITCH       381.1824 441.5359    +15.8%      p=0.1096  ns  NOT SUPPRESSED
  IRF8       SWITCH        73.8701  71.0924     -3.8%      p=0.1799  ns  NOT SUPPRESSED
  CEBPA      SWITCH         0.0238   0.0060    -74.6%      p=0.0653  ns  NOT SUPPRESSED
  CEBPE      SWITCH         0.3928   0.9240   +135.3%      p=0.0285   *  INVERTED
  ELANE      SWITCH       702.5027 401.8959    -42.8%    p=1.24e-03  **  CONFIRMED
  CD34       FA           340.5132 381.7405    +12.1%      p=0.3254  ns  NOT ELEVATED
  HOXA9      FA            13.7605  12.8453     -6.7%      p=0.0723  ns  NOT ELEVATED
  MEIS1      FA           377.5807 387.4681     +2.6%      p=0.4474  ns  NOT ELEVATED
  FLT3       FA            86.0476  95.7957    +11.3%      p=0.4092  ns  NOT ELEVATED
  MPO        FA             0.3166   0.1480    -53.3%      p=0.0582  ns  NOT ELEVATED
  SF3B1      SPLICING     414.4740 375.1396     -9.5%      p=0.0610  ns  SEE DATA
  SRSF2      SPLICING     152.4823 136.0350    -10.8%      p=0.0496   *  SEE DATA
  U2AF1      SPLICING     383.9001 326.1563    -15.0%    p=5.42e-03  **  SEE DATA
  ZRSR2      SPLICING      68.6792 103.3487    +50.5%    p=6.90e-06 ***  SEE DATA
  MYC        SCAFFOLD     258.4389 394.7525    +52.7%      p=0.0209   *  SEE DATA
  MKI67      SCAFFOLD     240.9988 213.2427    -11.5%      p=0.0828  ns  SEE DATA
  EZH2       EPIGENETIC    81.3513  60.0245    -26.2%    p=7.32e-04 ***  SEE DATA
  TET2       EPIGENETIC   101.3482 107.0613     +5.6%      p=0.3613  ns  SEE DATA
  DNMT3A     EPIGENETIC    82.7096  95.2828    +15.2%      p=0.1388  ns  SEE DATA
  ASXL1      EPIGENETIC    95.3708  71.4919    -25.0%    p=2.50e-03  **  SEE DATA

  Results: ./mds_false_attractor/results/saddle_results.csv

=== STEP 5: MUTATION SUBTYPE ANALYSIS ===

======================================================================
MUTATION SUBTYPE ANALYSIS
SF3B1 / SRSF2 / U2AF1 / ZRSR2
Do different mutations show different block depths?
======================================================================

  Subtype            n      SPI1      KLF4      IRF8      CD34     HOXA9     MEIS1
  ------------------------------------------------------------------------
  SF3B1_MUT         28    5.4565  457.6190   65.9841  288.4376   12.2478  372.5688
  SRSF2_MUT          8    6.2488  494.2924   68.7700  430.6284   10.7405  400.4680
  U2AF1_MUT          6    7.9096  411.9477   96.0465  408.1406   12.4182  452.1603
  ZRSR2_MUT          0  (no samples)
  ALL_WT            40    6.6301  424.1647   71.3896  433.3149   13.7486  385.5939

=== STEP 6: BLOCK DEPTH SCORING ===

======================================================================
BLOCK DEPTH SCORING — MDS SAMPLES
Score = switch gene suppression + FA elevation
======================================================================
  Component 1: Switch suppression   genes=['SPI1', 'KLF4', 'IRF8', 'CEBPA', 'CEBPE', 'ELANE']
  Component 2: FA elevation   genes=['CD34', 'HOXA9', 'MEIS1', 'FLT3', 'MPO']

  Depth statistics (82 MDS samples):
    Mean   : 0.5163
    Median : 0.5139
    Std    : 0.1476
    Min    : 0.0387
    Max    : 0.9752
    Q25    : 0.4440
    Q75    : 0.5953

  Block depth by mutation subtype:
    SF3B1_MUT (n= 28): 0.4784  vs  WT (n= 54): 0.5359  p=0.0077
    SRSF2_MUT (n=  8): 0.4285  vs  WT (n= 74): 0.5257  p=0.4280
    U2AF1_MUT (n=  6): 0.5777  vs  WT (n= 76): 0.5114  p=0.1662

=== STEP 7: DRUG TARGET DERIVATION ===

======================================================================
DRUG TARGET DERIVATION — FROM GEOMETRY
Stated before literature consultation
======================================================================

  Block depth correlations:
  Gene              r  p-value
  ----------------------------------
  ELANE       -0.7679  p=3.84e-17
  CD34        +0.6957  p=4.03e-13
  MEIS1       +0.4228  p=7.60e-05
  FLT3        +0.4168  p=9.83e-05
  DNMT3A      +0.3768  p=4.84e-04
  ZRSR2       +0.3276  p=2.66e-03
  MYC         -0.3085  p=4.81e-03
  MKI67       -0.2993  p=6.31e-03
  SF3B1       +0.2927  p=7.62e-03
  HOXA9       +0.2772  p=1.17e-02
  TET2        +0.2621  p=1.74e-02
  KLF4        -0.2489  p=2.41e-02
  EZH2        -0.1908  p=8.60e-02
  SPI1        +0.1710  p=1.25e-01
  ASXL1       +0.1629  p=1.44e-01
  U2AF1       -0.1479  p=1.85e-01
  CEBPE       +0.1133  p=3.11e-01
  MPO         +0.0900  p=4.22e-01
  SRSF2       -0.0588  p=6.00e-01
  IRF8        -0.0556  p=6.20e-01
  CEBPA       +0.0082  p=9.42e-01

  Switch gene expression:
  Gene          Normal       MDS    Change
  --------------------------------------------
  SPI1          7.4612    6.2858    -15.8%
  KLF4        381.1824  441.5359    +15.8%
  IRF8         73.8701   71.0924     -3.8%
  CEBPA         0.0238    0.0060    -74.6%
  CEBPE         0.3928    0.9240   +135.3%
  ELANE       702.5027  401.8959    -42.8%

  ============================================================
  DRUG TARGET PREDICTIONS — DERIVED FROM DATA
  Stated before literature consultation
  ============================================================

  PREDICTION 1: DIFFERENTIATION INDUCTION
    Switch genes suppressed in MDS HSPCs
    Same myeloid TFs as AML: SPI1 / KLF4 / IRF8 / CEBPA
    Forcing switch gene expression → differentiation
    Hypomethylating agents (HMAs) may partially
    restore switch gene expression
    Azacitidine / decitabine mechanism prediction:
    demethylate silenced switch gene promoters

  PREDICTION 2: SPLICING FACTOR TARGETING
    SF3B1/SRSF2/U2AF1/ZRSR2 mutations define subtypes
    Each mutation creates a different block depth
    Spliceosome inhibitors may correct aberrant
    splicing of switch gene transcripts
    Mutation subtype determines which inhibitor

  PREDICTION 3: BLOCK DEPTH STRATIFICATION
    Block depth score predicts HMA response
    High depth → deeper suppression → more HMA needed
    Low depth → partial suppression → differentiation
    therapy window still open

  PREDICTION 4: AML TRANSFORMATION RISK
    Block depth increases as MDS progresses to AML
    MDS samples with depth scores approaching AML range
    are at highest transformation risk
    Block depth at diagnosis = transformation predictor
  ============================================================
    

=== STEP 8: FIGURE ===

  Figure saved: ./mds_false_attractor/results/mds_false_attractor.png